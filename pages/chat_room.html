<form

	ng-if 			= "!room"
	layout			= "column"       
	layout-align	= "center center"
	ng-submit 		= "newRoom(room_name)"
	flex			= "shrink"
>

	<div
		layout			= "row"
		layout-align	= "center center"
	>
		<md-input-container>
				<label>Neuer Raum</label>
				<input 
					type			= "text"
					ng-model		= "room_name" 
					md-maxlength	= "100" 
					focus-me
					required 
				/>
		</md-input-container>
	</div>
	<div
		layout			= "row"
		layout-align	= "center center"
	>
		<md-button class="md-primary" type = "submit">Anlegen</md-button>
	</div>

</form>






<div
	layout 	= "row"
	flex	= "shrink"
	ng-if	= "room"
>
	
	<!-- list of participants -->

	<md-sidenav
		ng-if				= "room"
		md-is-open			= "true"
		md-is-locked-open 	= "true"
		flex				= "none"
		class				= "participant-list"
	>
		<md-list flex>
			<md-list-item
				ng-repeat 	= "participant in chat.participants"
			>
				<img
					ng-if	= "participant.avatar" 
					ng-src	= "/dpd-exchange/public/avatars/{{participant.avatar}}" 
					class	= "md-avatar"
				/>

				<div 
					class 	= "md-avatar"
					ng-if	= "!participant.avatar"
				>
					<md-icon class = "md-avatar-icon">face</md-icon>
				</div>

				<div class="md-list-item-text" layout="column">
					<h3>{{participant.displayName}}</h3>
					<!--
					<h4>{{ item.what }}</h4>
					<p>{{ item.notes }}</p>
					-->
				</div>
			</md-list-item>
		</md-list>
	</md-sidenav>


	<!-- chat messages -->

	<md-content
		layout				= "column"
		flex				= "grow"
		scroll-to-bottom 	= "chat.messages"
	>

		<md-list>
			<md-list-item 
				class		= "md-3-line md-long-text"
				ng-repeat   = "message in chat.messages"
				md-colors	= "{background: message.from.id == jhvwUser.data.id ? 'accent-200' : 'primary-200'}"
			>
					<img 
						ng-src	= "/dpd-exchange/public/avatars/{{message.from.avatar}}" 
						class	= "md-avatar" 
						alt		= "{{message.from.displayName}}" 
					/>
					<div class="md-list-item-text">
						<h3>{{message.from.displayName}}</h3>
						<p style = "white-space: pre-wrap">{{message.content}}</p>
					</div>
			</md-list-item>
		</md-list>






<!-- 
		<div
			ng-repeat   	= "message in chat.messages"
			class			= "message-container"
			flex			= "none"
			layout			= "row"
			layout-padding
		>
			<div 
				ng-if	= "message.from.id != jhvwUser.data.id "
				class 	= "avatar"
				flex	= "10"
			>
			</div>
			<div
				class		= "message"
				md-colors	= "{background: message.from.id == jhvwUser.data.id ? 'accent-200' : 'primary-400'}"
				flex		= "grow"
			>
				<div class = "from">
					<span class = "display-name">{{message.from.displayName}}</span>
					<span class = "userid">{{message.from.id}})</span></div>
				<div 
					class = "content"
					style = "white-space: pre-wrap"
				>{{message.content}}</div>
				<div class = "timestamp">{{message.timestamp}}</div>
			</div>

			<div 
				ng-if	= "message.from.id == jhvwUser.data.id "
				class 	= "avatar"
				flex	= "10"
			>
			</div>
		</div>
 -->
		<br/>
		<br/>

	</md-content>




	<md-sidenav
		ng-if				= "room"
		md-is-open			= "true"
		md-is-locked-open 	= "true"
		flex				= "none"
	>
		<jhvw-profile
			layout		= "column"
			layout-padding
		>
		</jhvw-profile>
	</md-sidenav>

</div>



<!-- new message -->

<form 
	ng-if		= "room"
	ng-submit 	= "post()"
	layout		= "row"
	flex		= "none"
	class		= "chat-input"
	layout-padding
>
	
			<md-input-container 
				flex 		= "grow"
				class		= "md-primary"
			>
					<label>Nachricht</label>
					<textarea 
						ng-model		= "message.content" 
						ng-keypress 	= "postOrLinebreak($event)"
						md-maxlength	= "600"
						rows			= "1"
						focus-me
						md-no-resize
						required 
					></textarea>
			</md-input-container>

			<md-button 
				class	= "md-primary" 
				type 	= "submit"

			> Submit </md-button>
</form>


